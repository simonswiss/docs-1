---
title: Keystatic & Astro
description: Add content to your Astro project using Keystatic as a CMS
type: cms
service: Keystatic
i18nReady: false
---
import FileTree from '~/components/FileTree.astro'
import PackageManagerTabs from '~/components/tabs/PackageManagerTabs.astro'
import Aside from '~/components/Aside.astro'

[Keystatic](https://keystatic.com/) is an open source, headless content-management system that allows you to structure your content and sync it with GitHub.

:::tip
If you're starting a **new Astro + Keystatic project from scratch**, you can use the [Keystatic CLI](https://keystatic.com/docs/quick-start#keystatic-cli) to generate a new project in seconds:

```bash
npm create @keystatic@latest
```

Select the Astro template, and you'll be ready to [deploy](#deploying-keystatic--astro)!
:::

## Prerequisites

- An existing Astro project [with server-side rendering (SSR) and `output: 'hybrid'` configured](/en/guides/server-side-rendering/#enabling-ssr-in-your-project).

:::note
If you intend to sync Keystatic's data with GitHub, you will also need **a GitHub account with `write` permissions** on the repository for this project.
:::

## Installing dependencies

Add both the Markdoc (for content entries) and the React (for the Keystatic Admin UI Dashboard) integrations to your Astro project, using the `astro add` command for your package manager.

```bash
npx astro add react markdoc
```

You will also need two Keystatic packages:

<PackageManagerTabs>
  <Fragment slot="npm">
  ```shell
  npm install @keystatic/core @keystatic/astro
  ```
  </Fragment>
  <Fragment slot="pnpm">
  ```shell
  pnpm install @keystatic/core @keystatic/astro
  ```
  </Fragment>
  <Fragment slot="yarn">
  ```shell
  yarn add @keystatic/core @keystatic/astro
  ```
  </Fragment>
</PackageManagerTabs>

## Creating a Keystatic config file

Keystatic needs a config file. This is where you can connect a project with a specific GitHub repository and define a content schema.

Create a file called `keystatic.config.ts` in the root of the project:

```ts {8-25}
// keystatic.config.ts
import { config, fields, collection } from '@keystatic/core';

export default config({
  storage: {
    kind: 'local',
  },
  collections: {
    posts: collection({
      label: 'Posts',
      slugField: 'title',
      path: 'src/content/posts/*',
      format: { contentField: 'content' },
      schema: {
        title: fields.slug({ name: { label: 'Title' } }),
        content: fields.document({
          label: 'Content',
          formatting: true,
          dividers: true,
          links: true,
          images: true,
        }),
      },
    }),
  },
});
```

You've exported a config object wrapped in the `config` function imported from `@keystatic/core`.

For now, the `storage` strategy is set to `local`, and there is a single ‚Äúposts‚Äù `collection`.

:::note
The schema of your Keystatic collections should match the collections you've defined in Astro's [content collections](/en/guides/content-collections/#defining-collections).

We're working on a way to automatically sync Keystatic collections with Astro's content collections... Stay tuned! ü§ó
:::

This is all Keystatic needs to start managing content, configuration-wise.

Now, you need to display the Keystatic Admin UI on our site!

## Setting up the Keystatic Admin UI dashboard

The Keystatic Admin UI is a React app that runs in your Astro project. The following steps will set it up to live in your `/pages/` folder, and provide a dashboard for managing your content.

1. Create a `keystatic.page.ts` in the project root, alongside your Keystatic config file.

    ```ts
    // keystatic.page.ts
    import { makePage } from '@keystatic/astro/ui'
    import keystaticConfig from './keystatic.config'
    
    export const Keystatic = makePage(keystaticConfig)
    ```

2. Create a new page called `src/pages/keystatic/[...params].astro` and mount the component on the client side only:

    ```astro
    ---
    // src/pages/keystatic/[...params].astro
    import { Keystatic } from '../../../keystatic.page'
    export const prerender = false
    ---
    
    <Keystatic client:only />
    ```

3. Create a new file called `src/pages/api/keystatic/[...params].ts` that will create `API routes` for Keystatic's Admin UI.

    ```jsx
    // src/pages/api/keystatic/[...params].ts
    import { makeHandler } from '@keystatic/astro/api'
    import keystaticConfig from '../../../../keystatic.config'
    
    export const all = makeHandler({
      config: keystaticConfig,
    })
    
    export const prerender = false
    ```

4. To launch your Keystatic Admin UI dashboard, start Astro's dev server:

    ```bash
    npm run dev
    ```

5. Visit `http://127.0.0.1:3000/keystatic` in the browser to see the Keystatic Admin UI running.

## Creating a new post

Try and visit the `/keystatic` page in the browser one more time, and click on the ‚ÄúPosts‚Äù collection.

Go ahead, and create a new post.

:::note
In our Keystatic config file, you've set the `path` property for our `posts` collection to `src/content/posts/*`.

As a result, creating a new post from the Keystatic Admin UI should create a new `content` directory in the `src` directory, with the new post `.mdoc` file inside.
:::

If everything worked correctly, you'll find your new post inside the `src/content/posts` directory:

<FileTree title="Project Structure">
- src/
  - content/
    - posts/
      - **my-first-post.mdoc**
</FileTree>

That Markdoc file should look something like this:

```markdown
---
title: My First Post
---

This is my very first post. I am **super** excited.
```

Niiiice ‚ú®

Time to display that post on the frontend now.

## Rendering Keystatic content

:::tip
While Keystatic provides its own [Reader and Renderer APIs](https://keystatic.com/docs/reader-api) to pull data for your frontend, it also works great with Astro's [content collections](/en/guides/content-collections/)!
:::

### Displaying a collection list

Since you instructed Keystatic to manage `posts` in `src/content/posts`, they'll be available as Astro's content collections as the `posts` collection slug:

```tsx {4}
---
import { getCollection } from 'astro:content'

const posts = await getCollection('posts')
---

<main>
  <pre>{JSON.stringify(posts, null, 2)}</pre>
</main>

```

### Displaying a single collection entry

You can also get a single collection entry by its slug:

```tsx {4}
---
import { getEntry } from 'astro:content'

const post = await getEntry('posts', 'my-first-post')
---

<main>
  <pre>{JSON.stringify(post, null, 2)}</pre>
</main>
```

### Rendering document field content

If you examine the output from our `post` entry above, you will notice that the `body` field ‚Äî which represents the `content` of our post ‚Äî is displaying raw Markdown.

But you probably want to render HTML instead on your page.

Well, good news: Astro provides a `<Content />` component that can do the heavy lifting of converting rich text data into properly formatted markup:

```tsx {4-5}
---
import { getEntry } from 'astro:content'

const post = await getEntry('posts', 'my-first-post')
const { Content } = await post.render()
---

<main>
  <h1>{post.data.title}</h1>
  <Content />
</main>

```

## Deploying Keystatic + Astro

To deploy your website, visit our [deployment guides](/en/guides/deploy/) and follow the instructions for your preferred hosting provider.

You'll also probably want to [connect Keystatic to GitHub](https://keystatic.com/docs/connect-to-github) so you can manage content on the deployed instance of the project.

## Official Resources

- Check out [the official Keystatic guide](https://keystatic.com/docs/installation-astro)
- [Keystatic starter template](https://github.com/Thinkmill/keystatic/tree/main/templates/astro)
